<p id="notice"><%= notice %></p>
<h2><%= @barbecue.title %></h2>
<h3><%= link_to 'I bring something !', new_barbecue_supply_path(@barbecue), class: "btn btn-primary btn-lg" %></h3>
<div class="container col-md-6">
  <div class="highlight">
    <h3>Barbecue description</h3>
    <%= @barbecue.description %>
  </div>
  <h3>Barbecue details</h3>
  <p><h4>Organised by:</h4><%= @barbecue.user.name %></p>
  <p><h4>Begin date:</h4><%= @barbecue.begin_date %></p>
  <h3>Who comes ?</h3>
  <% if @attending_users.count() > 0 %>
    <ul>
      <% @attending_users.each() do |user| %>
        <li><%= user.name %></li>
      <% end %>
    </ul>
  <% else %>
    Nobody yet
  <% end %>
</div>
<div class="container col-md-4">
  <h3>What we need</h3>
  <% if @barbecue.barbecue_ingredient.count() > 0 %>
    <ul>
      <% @barbecue.barbecue_ingredient.each() do |barbecue_ingredient| %>
        <li><%= link_to(pluralize(barbecue_ingredient.quantity, barbecue_ingredient.ingredient.title), edit_barbecue_ingredient_path(barbecue_ingredient)) %></li>
      <% end %>
    </ul>
  <% else %>
    <p>Nothing yet</p>
  <% end %>
  <% if user_signed_in? and @barbecue.user.id == current_user.id %>
    <%= link_to 'Add ingredients', edit_barbecue_path(@barbecue) %>
  <% end %>
  <h3>We already have</h3>
  <% if @barbecue.supply.count() > 0 %>
    <ul>
      <% @barbecue.supply.map(&:ingredient).uniq.each do |ingredient| %>
        <li>
          <% if @contributions.include?(ingredient.id) %>
            <%= pluralize(@contributions[ingredient.id], ingredient.title) %>
          <% end %>
        </li>
      <% end %>
    </ul>
  <% else %>
    Nothing yet
  <% end %>
</div>
<div class="container col-md-2">
  <h3>QR Code</h3>
  <table class="qr-code">
    <% @qr.modules.each_index do |x| -%>
      <tr>
        <% @qr.modules.each_index do |y| -%>
          <% if @qr.dark?(x,y) -%>
            <td class="black"/>
          <% else -%>
            <td class="white"/>
          <% end -%>
        <% end -%>
      </tr>
    <% end -%>
  </table>
  <h6>Send a photo to your friends</h6>
</div>
<% if user_signed_in? and @barbecue.user.id == current_user.id %>
  <%= link_to 'Edit', edit_barbecue_path(@barbecue) %> |
<% end %>
<%= link_to 'Back', barbecues_path %>
